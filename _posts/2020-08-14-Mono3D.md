---
layout: post
title: Mono3D
tags: [Computer Vision, 3D Object Detection, 3D Localization]
mathjax: true
comments: true
---

这篇博客分享的是 CVPR 2016 的一篇论文，该论文研究自动驾驶场景中物体3D检测问题。从时间上来看该文算是自动驾驶3D物体检测
比较早的研究了，其中的方法在当时来看比较前沿，但是现在看有点老旧——部分模块还在用SVM等机器学习模型，因为这个领域的进展非常快，每年都会涌现大量文章，清一色基于深度学习模型。选择分享这篇文章，是因为它比较经典，引用量达接近400 —— 后续文章在做介绍和对比试验的时候不约而同提到了它。

论文标题：[Monocular 3D Object Detection for Autonomous Driving](https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Chen_Monocular_3D_Object_CVPR_2016_paper.pdf)

论文作者：Xiaozhi Chen, Kaustav Kundu, Ziyu Zhang, Huimin Ma, Sanja Fidler, Raquel Urtasun（来自清华大学、多伦多大学）

### 简介
当前（本文指2016年之前的几年），自动驾驶系统大部分依赖于雷达和人工标注的地图，本文关注从单目图像进行2D和3D物体检测。最近的目标检测工作流程，习惯上先生成各式各样的 object proposals，这样做的好处有两个：一是避免没有目的地全部搜索从而加速计算，二是能提高物体检测召回率。本文沿用了这样的思路。

生成 object proposal 的方法，有下面几类：
* over-segment the image into superpixels and group these using several similarity measures [45, 2]
* explore an exhaustive set of windows using simple “objectness” features [1, 11], or contour information
* recent works learn how to propose promising object candidates using
    * ensembles of binary segmentation models [27]
    * parametric energies [29]
    * window classifiers based on CNN features [18]

这些方法在 PASCAL VOC 数据集上展示出了较好的效果，也就是说在2D检测方面表现良好，但是放到自动驾驶场景 —— KITTI数据集，之前表现好的方法就落后许多了。当前KITTI数据集上表现最好的是 Chen et al. 提出的方法，用双目图像生成3D object proposals。

本文的方法与此类似，利用单目图片上下文和语义信息，让模型学习生成 class-specific 3D object proposals。这些 proposals 通过详尽地把3D BBox 放到地平面并用简单有效的图片特征对它们打分的方式生成，图片特征包括：物体类别语义，物体实例语义，物体形状、位置，物体上下文（指物体外加所在地面）。实验表明该模型在KITTI数据集达到了单目图像SOTA，与双目效果接近。

### 相关工作
* Object Proposal Generation
    * RGB
        * K. Van de Sande, J. Uijlings, T. Gevers, and A. Smeulders. Segmentation as selective search for object recognition. In ICCV, 2011.
        * L. Zitnick and P. Doll´ar. Edge boxes: Locating object pro- posals from edges. In ECCV. 2014.
        * J. Carreira and C. Sminchisescu. Cpmc: Automatic object segmentation using constrained parametric min-cuts. PAMI, 34(7):1312–1328, 2012.
        * P. Arbelaez, J. Pont-Tusetand, J. Barron, F. Marques, and J. Malik. Multiscale combinatorial grouping. In CVPR. 2014.
        * M. Cheng, Z. Zhang, M. Lin, and P. Torr. BING: Binarized normed gradients for objectness estimation at 300fps. In CVPR, 2014.
        * T. Lee, S. Fidler, and S. Dickinson. A learning framework for generating region proposals with mid-level cues. In ICCV, 2015.
    * RGB-D
        * D. Banica and C. Sminchisescu. Cpmc-3d-o2p: Semantic segmentation of rgb-d images using cpmc and second order pooling. In CoRR abs/1312.7715, 2013.
        * S. Gupta, R. Girshick, P. Arbelaez, and J. Malik. Learning rich features from RGB-D images for object detection and segmentation. In ECCV. 2014.
        * D. Lin, S. Fidler, and R. Urtasun. Holistic scene understand- ing for 3d object detection with rgbd cameras. In ICCV, 2013.
        * A. Karpathy, S. Miller, and L. Fei-Fei. Object discovery in 3d scenes via shape analysis. In ICRA, 2013.
    * Video
        * D. Oneata, J. Revaud, J. Verbeek, and C. Schmid. Spatio- temporal object detection proposals. In ECCV, 2014.
    * learn to propose objects
        * T. Lee, S. Fidler, and S. Dickinson. A learning framework for generating region proposals with mid-level cues. In ICCV, 2015.
        * P. Kr ahenb uhl and V. Koltun. Geodesic object proposals. In ECCV, 2014.
        * P. Kr ahenb uhl and V. Koltun. Learning to propose objects. In CVPR, 2015.
        * A. Ghodrati, A. Diba, M. Pedersoli, T. Tuytelaars, and L. V. Gool. Deepproposal: Hunting objects by cascading deep convolutional layers. In arXiv:1510.04445, 2015.
* 3D Object Detection
    * X. Chen, K. Kundu, Y. Zhu, A. Berneshawi, H. Ma, S. Fidler, and R. Urtasun. 3d object proposals for accurate object class detection. In NIPS, 2015.（**双目**）
    * M. Zia, M. Stark, and K. Schindler. Towards scene under- standing with detailed 3d object representations. IJCV, 2015.
    * B. Pepik, M. Stark, P. Gehler, and B. Schiele. Multi-view and 3d deformable part models. PAMI, 2015.
    * P. F. Felzenszwalb, R. B. Girshick, D. McAllester, and D. Ramanan. Object detection with discriminatively trained part based models. PAMI, 2010.（**DPM**）
    * S. Fidler, S. Dickinson, and R. Urtasun. 3d object detec- tion and viewpoint estimation with a deformable 3d cuboid model. In NIPS, 2012.
    * E. Ohn-Bar and M. M. Trivedi. Learning to detect vehicles by clustering appearance patterns. IEEE Transactions on In- telligent Transportation Systems, 2015.（**visual and geometric information**）
    * C. Long, X. Wang, G. Hua, M. Yang, and Y. Lin. Accu- rate object detection with location relaxation and regionlets relocalization. In ACCV, 2014.
    * S. Wang, S. Fidler, and R. Urtasun. Holistic 3d scene under- standing from a single geo-tagged image. In CVPR, 2015.
    * Y. Xiang, W. Choi, Y. Lin, and S. Savarese. Data-driven 3d voxel patterns for object category recognition. In CVPR, 2015.（**3DVP**）

### 主要方法
* 模型整体结构
    ![](../img/post/mono3d_architecture.png)
    - 红色箭头`projection`这一步，我理解的是把3D投影到2D，就可以利用图片信息了，中间红色大方框正是图片的各种特征，然后用评分方法给出proposal得分，后续用NMS处理
    - 问题是：上面的操作都在2D图片上进行，最后怎么得到3D Proposals？？扩展的方法是什么？？

### 实验

### 思考和讨论